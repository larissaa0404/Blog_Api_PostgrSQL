<%-include("partials/header.ejs") %>

<body>
    <div class="container loginPage">
        <form action="/api/users" method="post" class="login-form validate-form">
            <h1 class="login-form-title">
            Register
            </h1>
            <div class="form mb-3" id="userName">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
              </svg>
              <input type="text" name="name" id="name" placeholder="Full Name" onchange="fieldValid(event, 'userName')" onkeyup="fieldValid(event, 'userName')" required>
              
            </div>
            <div class="form mb-3" id="userEmail">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                  <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414zM0 4.697v7.104l5.803-3.558zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586zm3.436-.586L16 11.801V4.697z"/>
                </svg>
                <input type="email" name="username" id="username" placeholder="E-mail" onchange="fieldValid(event, 'userEmail')" onkeyup="fieldValid(event, 'userEmail')" required>
                
              </div>
              <div class="form mb-3" id="pass">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock-fill" viewBox="0 0 16 16">
                  <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2m3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"/>
                </svg>
                <input type="password" name="password" id="password" placeholder="Password" onchange="passValid(event, 'pass')" onkeyup="passValid(event, 'pass')" required>
                
              </div>
              <div class="form mb-3" id="passconf">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock-fill" viewBox="0 0 16 16">
                  <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2m3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"/>
                </svg>
                <input type="password" name="passwordConf" id="passwordConf" placeholder="Password Confirm" onchange="passValid(event, 'passconf')" onkeyup="passValid(event, 'passconf')" required>
                
              </div>
            <div class="container-login-form-btn">
                <button class="login-form-btn">
                     Register
                </button>
            </div>
           
        </form>
    </div>
    <script>
      const validEmailFormat = (email) => {
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailPattern.test(email);
      };
  
      const fieldValid = (event, parentId) => {
        let field = event.target;
        let parentDiv = document.getElementById(parentId);
  
        if(!field.value) {
          parentDiv.classList.add("invalid");
          parentDiv.classList.remove("valid");
          return false;
        } else {
          if (field.name =="username") {
            if (!validEmailFormat(field.value.trim())) {
              parentDiv.classList.add("invalid");
              parentDiv.classList.remove("valid");
              return false;
            } else {
              parentDiv.classList.remove("invalid");
              parentDiv.classList.add("valid");
              return true;
            }
          } else {
            parentDiv.classList.remove("invalid");
            parentDiv.classList.add("valid");
            return true;
          }
        }
      }
  
      const passValid = (event, parentId) => {
        let field = event.target;
        let parentDiv = document.getElementById(parentId);
  
        if(!field.value) {
          parentDiv.classList.add("invalid");
          parentDiv.classList.remove("valid");
          return false;
        } else {
          if (document.querySelector('[name = "password"]').value == document.querySelector('[name = "passwordConf"]').value) {
            document.getElementById('pass').classList.add("valid");
            document.getElementById('passconf').classList.add('valid');
            document.getElementById('pass').classList.remove("invalid");
            document.getElementById('passconf').classList.remove('invalid');
            return true;
          } else {
            document.getElementById('pass').classList.remove("valid");
            document.getElementById('passconf').classList.remove('valid');
            document.getElementById('pass').classList.add("invalid");
            document.getElementById('passconf').classList.add('invalid');
          }
        }
        
      }
  
    </script>
</body>

<%-include('partials/footer.ejs')  %>